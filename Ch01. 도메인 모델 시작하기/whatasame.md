## 1.1 도메인이란?

* 도메인이란 소프트웨어로 해결하고자 하는 문제 영역을 말한다.
* 도메인은 다시 하위 도메인으로 나눌 수 있다.
* 한 하위 도메인은 다른 하위 도메인과 연동하여 완전한 기능을 제공한다.

## 1.2 도메인 전문가와 개발자 간 지식 공유

* 요구사항을 제대로 이해하지 않으면 쓸모없거나 유용함이 떨어지는 시스템을 만든다.
* 요구사항을 올바르기 이해하기 위한 방법은 도메인 전문가와 대화하는 것이다.
* 소프트웨어 지식이 부족한 도메인 전문가는 원하는 기능을 제대로 표현하지 못하는 경우가 있다.

## 1.3 도메인 모델

* 도메인 모델은 특정 도메인을 개념적으로 표현한 것을 말한다.
* 도메인 모델을 표현하는 방법에는 정해진 것이 없다.
* 객체 도메인 모델은 도메인이 제공하는 기능과 도메인의 주요 데이터 구성을 파악하기 유용하다.
* 도메인 모델은 개념 모델이기 때문에 구현 기술에 맞는 구현 모델이 필요하다.
* 도메인에 따라 용어 의미가 결정되므로 같은 용어가 도메인에 따라 다른 의미를 가질 수 있다.

## 1.4 도메인 모델 패턴

* 도메인 모델 패턴은 아키텍처 상의 도메인 계층을 객체 지향 기법으로 구현하는 패턴을 말한다.
* 도메인 계층은 도메인의 핵심 규칙을 구현한다.
* 핵심 규칙을 구현한 코드는 도메인 모델에만 위치하기 때문에 변경 시 다른 코드에 영향을 덜 주고 변경 내역을 모델에 반영할 수 있다.
* 도메인 모델은 도메인 자체를 표현하는 개념적 모델을 의미하면서도 도메인 계층을 구현할 때 사용하는 객체 모델을 가리키기도 한다.
* 처음부터 완벽하게 도메인을 표현하는 모델을 만드는 것은 불가능하다.
* 전반적인 개요를 알 수 있는 수준으로 개념 모델을 작성한 후 전체 윤곽에 집중하고 구현 과정을 통해 점진적으로 발전시켜 나가야 한다.

## 1.5 도메인 모델 도출

* 도메인을 모델링할 때 기본이 되는 작업은 모델을 구성하는 핵심 구성요소, 규칙, 기능을 찾는 것이다.
* 문서화를 하는 이유는 지식을 공유하기 위함이다. 상위 수준에서 정리한 문서를 참조하는 것이 코드를 보는 것보다 빠르게 이해할 수 있다.
* 단순히 코드를 보기 좋게 작성하는 것뿐만 아니라 도메인 관점에서 코드가 도메인을 잘 표현해야 가독성이 높아지고 문서로서 의미를 갖는다.

## 1.6 엔티티와 밸류

### 엔티티

* 엔티티의 가장 큰 특징은 식별자를 가진다는 것이다.
* 엔티티의 식별자는 생성 시점에 할당되어 속성을 바꾸고 삭제할 때까지 유지된다.
* 엔티티의 식별자는 바뀌지 않고 고유하기 때문에 `equals()`와 `hashCode()` 메서드를 구현할 때 사용한다.

### 밸류

* 밸류 타입은 개념적으로 완전한 하나를 표현할 때 사용한다. 예를 들어, 받는 사람의 이름과 주소를 묶어 `Recevier`로 표현할 수 있다.
* 밸류 타입을 통해 의미를 명확하게 표현할 수 있다. 또, 타입에 기능을 추가하면 기능에 의미를 부여할 수 있다.
* 밸류 객체는 불변으로 구현하는 것이 좋다. 불변으로 구현하면 참조 투명성을 지킬 수 있고 thread-safe하다.
  > 참조 투명성: 외부의 영향을 받지 않는 것
* 밸류 객체를 비교할 땐, 모든 속성이 같은지 비교한다.

### Getter/Setter

* Getter와 Setter를 습관적으로 추가하는 것은 좋지 않은 버릇이다.
* 특히, Setter의 경우 도메인의 핵심 개념과 의도를 코드에서 사라지게 한다.
* 또한, 값의 초기화를 Setter를 할 경우 도메인 객체를 생성할 때 온전하지 않은 상태가 될 수 있다. 이를 방지하기 위해선 생성자를 통해 필요한 데이터를 생성 시점에 필요한 것을 전달해야한다.

## 1.7 도메인 용어와 유비쿼터스 언어

* 코드에 도메인 용어를 사용하면 가독성이 높아져 코드를 분석하고 이해하는 시간을 줄어든다.
* 도메인 용어를 사용하면서 도메인 규칙을 코드로 작성하게 되므로 의미를 변환하는 과정에서 발생하는 버그도 줄어든다.
* stakeholders 사이에서 공통의 언어를 ubiqutous language라고 한다.
* 유비쿼터스 언어를 사용하면 소통 간에 발생하는 용어의 모호함을 줄일 수 있고 도메인-코드 사이의 해석 과정을 줄일 수 있다.
* 시간이 지나면서 도메인에 대한 이해가 높아지는데 새롭게 이해한 내용을 잘 표현할 수 있는 용어를 찾아내고 공통의 언어로 만들어 다 같이 사용한다.
* 새로 발견한 용어는 코드와 문서에 반영하여 산춘물에 최신 모델을 적용한다.

## 후기

개발자는 개발만 하고 기획자는 기획을 한다고 생각했던 적이 있었는데 개발자 또한 기획자를 도와 요구 사항에 기여하는 방향으로 개발을 해야한다고 생각한다.

도메인, 도메인 모델, 도메인 객체, 엔티티, 밸류와 같이 자주 사용하지만 정확한 의미를 모르고 사용했던 용어들에 대해 명확하게 정리할 수 있어서 좋았다.

애플리케이션을 설계할 때 처음부터 완벽한 설계를 바라는 것이 아니라 전체 윤곽에 집중할 수 있는 수준에서 만족하고 구현 과정을 통해 발전시킨다는 점이 인상깊었다.
또한, 시간이 지남에 따라 도메인 이해도가 높아지면서 더 적절한 용어를 찾게 되면 산출물에 최신 모델을 적용해야한다는 점도 공감됐다. 최근 TeamMember를 Crew로 변경했는데 이런 의미에서 적용한 것 같다.

한편, 이미 서비스를 사용하는 유저가 많아지는 경우에는 새로운 용어를 적용하기 어려울 수 있다는 점도 고려해야할 것 같다. 예를 들어, 테이블의 이름을 변경하거나 컬럼명을 변경하는 경우 데이터베이스 서버가 이를
처리하는 동안 중단될 수 있기 때문이다.

그렇다면 데이터베이스의 수정은 불가능한 것일까? 이에 관해서 이야기를 해본 결과 데이터베이스 인스턴스를 복제하는 것이 적합한 선택이라고 결론 지었다. 대신 복제되는 동안 새롭게 추가되는 데이터가
복제본에 누락될 수 있다. 이 경우 복제 처리 시간 동안 발생하는 이벤트를 이벤트 큐에 넣어서 보관한 후 복제가 완료되면 이벤트를 처리하여 원본과 복제본의 정합성을 일치 시킬 수 있을 것이다.

